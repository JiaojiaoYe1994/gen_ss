# gen_ss


Step 1
`test.ipynb`: Seg image with SAM and GroundDino

Step 2
`generate.py`  : Given mask and prompt, script to generate synthetic image with 'ControlNet' pretrained on ADE20K.

Step 3
`deeplab-python` train (optional: weakly supervised/ Few-shot) segmentation network with synthetic images. 


### 2️⃣ Datasets and Data Preparation

#### Pre-processed data from drive
PASCAL: The JPEG images can be found in the PASCAL-VOC 2012 toolkit to be downloaded at PASCAL VOC 2012 and SegmentationClassAug (pre-processed ground-truth masks).

COCO2014: COCO 2014 train images, validation images and annotations can be downloaded at COCO. Once this is done, you will have to generate the subfolders coco/train and coco/val (ground truth masks). Both folders can be generated by executing the python script data/coco/create_masks.py (note that this script uses the pycocotools package):

We provide the versions of PASCAL VOC 2012 and MS-COCO 2017 used in this work [here](). You can download the full .zip and directly extract it in the data/ folder.


#### Few-shot list 
The train/val splits are directly provided in 'lists/' . 
How they were obtained is explained [here](https://github.com/dvlab-research/PFENet)
Lists can be refereed as [here](https://mailnwpueducn-my.sharepoint.com/personal/langchunbo_mail_nwpu_edu_cn/_layouts/15/onedrive.aspx?id=%2Fpersonal%2Flangchunbo%5Fmail%5Fnwpu%5Fedu%5Fcn%2FDocuments%2FFSS%2Fbase%5Fannotation)

* The train/val lists for COCO contain 82081 and 40137 images respectively. They are the default train/val splits of COCO.
* The train/val lists for PASCAL5i contain 5953 and 1449 images respectively. The train list should be voc_sbd_merge_noduplicate.txt and the val list is the original val list of pascal voc (val.txt).